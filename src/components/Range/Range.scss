// <Range />
@import '@globals';

// Multi-Thumb Sliders: General Case
// https://css-tricks.com/multi-thumb-sliders-general-case/
// https://codepen.io/thebabydino/pen/vYEEara

$pad: 2rem;
$highlight-color: #f90;
$transition-duration: .3s;

@mixin track() {
	width: 100%; height: 100%;
	background: none /* get rid of Firefox track background */
}

@mixin thumb() {
	box-sizing: border-box; /* different between Chrome & Firefox */
	/* box-sizing needed now that we have a non-zero border */
	border: solid calc( .5 * var( --radius ) ) transparent;
	width: var( --diameter ); height: var( --diameter );
	border-radius: 50%; /* make circular */
	background: 
		linear-gradient( rgba( #000, .15 ), rgba( #fff, .2 ) ) content-box,
		linear-gradient( rgba( #fff, .3 ), rgba( #000, .3 ) ) border-box,
		$highlight-color;
	pointer-events: auto;
}

* {
	--highlighted: 0;
	--not-highlighted: calc( 1 - var( --highlighted ) );
	margin: 0;
	font: inherit;
}

body { 
	display: grid;
	place-content: center;
	overflow-x: hidden;
	min-height: 100vh;
  background:
    repeating-linear-gradient(
      45deg, 
      #ddd,
      #ddd 5px,
      transparent 0,
      transparent 7px
    )
    #eee
}

.wrap {
	--width: 20rem;
	--height: 1.75rem;
	--diameter: var( --height );
	--radius: calc( .5 * var( --diameter ) );
	--useful-width: calc( var( --width ) - var( --diameter ) ); // the track width minus the thumb diameter
	--min-max-difference: calc( var( --max ) - var( --min ) );
	display: grid;
	grid-template-rows: max-content var( --height ) max-content;
	grid-gap: .625rem;
	overflow: hidden;
	position: relative;
	// margin: 1em .5em - $pad;
	// padding: 0 $pad;
	width: var( --width );
	font: 700 1.125em ubuntu mono, consolas, monaco, monospace;
	
	&::before, &::after {
		grid-column: 1;
		grid-row: 2;
		border-radius: var( --radius );
		box-shadow: inset 0 2px 3px rgba( #000, .3 );
		background: #ccc;
		color: #eee;
		content: ''
	}
	
	&::after {
		/* non-standard WebKit version */
		-webkit-mask: var( --fill );
		-webkit-mask-composite: xor;
		/* standard version, supported in Firefox */
						mask: var( --fill );
						mask-composite: exclude;
		background: 
			linear-gradient( rgba( #fff, .3 ), rgba( #000, .3 ) )
			#95a;
	}
}

.sr-only {
	position: absolute;
	clip-path: inset(50%)
}

input[type='range'] {
	&::-webkit-slider-runnable-track, 
	&::-webkit-slider-thumb, & {
		-webkit-appearance: none
	}
	
	grid-column: 1;
	grid-row: 2;
	z-index: calc( 1 + var( --highlighted) );
	top: 0; left: 0;
	background: none; /* get rid of white Chrome background */
	filter: grayScale(var( --not-highlighted) );
	transition: filter $transition-duration ease-out;
	cursor: grab;
	pointer-events: none;
	
	&::-webkit-slider-runnable-track { @include track }
	&::-moz-range-track { @include track }
	
	&::-webkit-slider-thumb { @include thumb }
	&::-moz-range-thumb { @include thumb }
	
	&:focus {
		outline: solid 0 transparent;
		
		&, & + output { --highlighted: 1 }
	}
	
	&:active { cursor: grabbing	}
}

output {
	grid-column: 1;
	grid-row: 3;
	margin-left: var( --radius );
	max-width: max-content;
	transform: translate( calc( ( var( --value ) - var( --min ) ) / var( --min-max-difference ) * var( --useful-width ) ) );
	
	&::after {
		display: block;
		border-radius: 5px;
		padding: 0 .375rem;
		transform: translate(-50%) scale(var( --highlighted) );
		background: 
			linear-gradient( rgba( #fff, .3 ), rgba( #000, .3 ) )
			$highlight-color;
		color: #fff;
		transition: transform $transition-duration ease-out;
		counter-reset: value var( --value );
		content: counter( value );
	}
}

// .ml-range {}

// Styling Cross-Browser Compatible Range Inputs with CSS
// https://css-tricks.com/styling-cross-browser-compatible-range-inputs-css/

// input[type=range] {
//   -webkit-appearance: none;
//   margin: 18px 0;
//   width: 100%;
// }
// input[type=range]:focus {
//   outline: none;
// }
// input[type=range]::-webkit-slider-runnable-track {
//   width: 100%;
//   height: 8.4px;
//   cursor: pointer;
//   animate: 0.2s;
//   box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
//   background: #3071a9;
//   border-radius: 1.3px;
//   border: 0.2px solid #010101;
// }
// input[type=range]::-webkit-slider-thumb {
//   box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
//   border: 1px solid #000000;
//   height: 36px;
//   width: 16px;
//   border-radius: 3px;
//   background: #ffffff;
//   cursor: pointer;
//   -webkit-appearance: none;
//   margin-top: -14px;
// }
// input[type=range]:focus::-webkit-slider-runnable-track {
//   background: #367ebd;
// }
// input[type=range]::-moz-range-track {
//   width: 100%;
//   height: 8.4px;
//   cursor: pointer;
//   animate: 0.2s;
//   box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
//   background: #3071a9;
//   border-radius: 1.3px;
//   border: 0.2px solid #010101;
// }
// input[type=range]::-moz-range-thumb {
//   box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
//   border: 1px solid #000000;
//   height: 36px;
//   width: 16px;
//   border-radius: 3px;
//   background: #ffffff;
//   cursor: pointer;
// }
// input[type=range]::-ms-track {
//   width: 100%;
//   height: 8.4px;
//   cursor: pointer;
//   animate: 0.2s;
//   background: transparent;
//   border-color: transparent;
//   border-width: 16px 0;
//   color: transparent;
// }
// input[type=range]::-ms-fill-lower {
//   background: #2a6495;
//   border: 0.2px solid #010101;
//   border-radius: 2.6px;
//   box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
// }
// input[type=range]::-ms-fill-upper {
//   background: #3071a9;
//   border: 0.2px solid #010101;
//   border-radius: 2.6px;
//   box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
// }
// input[type=range]::-ms-thumb {
//   box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
//   border: 1px solid #000000;
//   height: 36px;
//   width: 16px;
//   border-radius: 3px;
//   background: #ffffff;
//   cursor: pointer;
// }
// input[type=range]:focus::-ms-fill-lower {
//   background: #3071a9;
// }
// input[type=range]:focus::-ms-fill-upper {
//   background: #367ebd;
// }